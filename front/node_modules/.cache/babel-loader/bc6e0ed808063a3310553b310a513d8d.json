{"remainingRequest":"/Applications/MAMP/htdocs/iim/nodejs/todo_app/front/node_modules/babel-loader/lib/index.js!/Applications/MAMP/htdocs/iim/nodejs/todo_app/front/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Applications/MAMP/htdocs/iim/nodejs/todo_app/front/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Applications/MAMP/htdocs/iim/nodejs/todo_app/front/src/molecules/LoginForm.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Applications/MAMP/htdocs/iim/nodejs/todo_app/front/src/molecules/LoginForm.vue","mtime":1618942067000},{"path":"/Applications/MAMP/htdocs/iim/nodejs/todo_app/front/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Applications/MAMP/htdocs/iim/nodejs/todo_app/front/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Applications/MAMP/htdocs/iim/nodejs/todo_app/front/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Applications/MAMP/htdocs/iim/nodejs/todo_app/front/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIi9BcHBsaWNhdGlvbnMvTUFNUC9odGRvY3MvaWltL25vZGVqcy90b2RvX2FwcC9mcm9udC9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vYXN5bmNUb0dlbmVyYXRvciI7CmltcG9ydCAicmVnZW5lcmF0b3ItcnVudGltZS9ydW50aW1lLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZGF0ZS50by1zdHJpbmcuanMiOwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwppbXBvcnQgdXNlcnMgZnJvbSAnLi4vYXBpL3VzZXJzJzsKaW1wb3J0IHN0b3JlIGZyb20gJ0Avc3RvcmUvaW5kZXgnOwppbXBvcnQgand0IGZyb20gJ2pzb253ZWJ0b2tlbic7CmltcG9ydCBDb29raWVzIGZyb20gImpzLWNvb2tpZSI7CmltcG9ydCBkYXlqcyBmcm9tICJkYXlqcyI7CmltcG9ydCB1dGMgZnJvbSAnZGF5anMvcGx1Z2luL3V0Yyc7CmRheWpzLmV4dGVuZCh1dGMpOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ0xvZ2luRm9ybScsCiAgcHJvcHM6IHsKICAgIGVtYWlsOiBTdHJpbmcsCiAgICBwYXNzd29yZDogU3RyaW5nCiAgfSwKICBzdG9yZTogc3RvcmUsCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIG11dGFibGVFbWFpbDogdGhpcy5lbWFpbCwKICAgICAgbXV0YWJsZVBhc3N3b3JkOiB0aGlzLnBhc3N3b3JkCiAgICB9OwogIH0sCiAgbWV0aG9kczogewogICAgbG9naW46IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9sb2dpbiA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSgpIHsKICAgICAgICB2YXIgcmVxLCB2ZXJpZmllZFRva2VuLCBleHBUb2tlbjsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjsKICAgICAgICAgICAgICAgIHJldHVybiB1c2Vycy5sb2dpblVzZXIoewogICAgICAgICAgICAgICAgICBlbWFpbDogdGhpcy5tdXRhYmxlRW1haWwsCiAgICAgICAgICAgICAgICAgIHBhc3N3b3JkOiB0aGlzLm11dGFibGVQYXNzd29yZAogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgIHJlcSA9IF9jb250ZXh0LnNlbnQ7CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNTsKICAgICAgICAgICAgICAgIHJldHVybiBqd3QudmVyaWZ5KHJlcS50b2tlbiwgJ3NlY3JldCcpOwoKICAgICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgICB2ZXJpZmllZFRva2VuID0gX2NvbnRleHQuc2VudDsKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA4OwogICAgICAgICAgICAgICAgcmV0dXJuIGRheWpzLnVuaXgodmVyaWZpZWRUb2tlbi5leHApLmZvcm1hdCgpOwoKICAgICAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgICAgICBleHBUb2tlbiA9IF9jb250ZXh0LnNlbnQ7CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTE7CiAgICAgICAgICAgICAgICByZXR1cm4gQ29va2llcy5zZXQoJ3Rva2VuJywgcmVxLnRva2VuLCB7CiAgICAgICAgICAgICAgICAgIGV4cGlyZXM6IG5ldyBEYXRlKGV4cFRva2VuKQogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGNhc2UgMTE6CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTM7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ3VzZXJzL1NUT1JFX1RPS0VOJywgcmVxLnRva2VuKTsKCiAgICAgICAgICAgICAgY2FzZSAxMzoKICAgICAgICAgICAgICAgIGlmIChyZXEuc3RhdHVzID09PSAyMDApIHsKICAgICAgICAgICAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goJy8nKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgY2FzZSAxNDoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUsIHRoaXMpOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBsb2dpbigpIHsKICAgICAgICByZXR1cm4gX2xvZ2luLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBsb2dpbjsKICAgIH0oKQogIH0KfTs="},{"version":3,"sources":["LoginForm.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4BA,OAAA,KAAA,MAAA,cAAA;AAEA,OAAA,KAAA,MAAA,eAAA;AACA,OAAA,GAAA,MAAA,cAAA;AACA,OAAA,OAAA,MAAA,WAAA;AAEA,OAAA,KAAA,MAAA,OAAA;AACA,OAAA,GAAA,MAAA,kBAAA;AAEA,KAAA,CAAA,MAAA,CAAA,GAAA;AAEA,eAAA;AACA,EAAA,IAAA,EAAA,WADA;AAEA,EAAA,KAAA,EAAA;AACA,IAAA,KAAA,EAAA,MADA;AAEA,IAAA,QAAA,EAAA;AAFA,GAFA;AAMA,EAAA,KAAA,EAAA,KANA;AAOA,EAAA,IAPA,kBAOA;AACA,WAAA;AACA,MAAA,YAAA,EAAA,KAAA,KADA;AAEA,MAAA,eAAA,EAAA,KAAA;AAFA,KAAA;AAIA,GAZA;AAaA,EAAA,OAAA,EAAA;AACA,IAAA,KAAA;AAAA,2EAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBACA,KAAA,CAAA,SAAA,CAAA;AACA,kBAAA,KAAA,EAAA,KAAA,YADA;AAEA,kBAAA,QAAA,EAAA,KAAA;AAFA,iBAAA,CADA;;AAAA;AACA,gBAAA,GADA;AAAA;AAAA,uBAKA,GAAA,CAAA,MAAA,CAAA,GAAA,CAAA,KAAA,EAAA,QAAA,CALA;;AAAA;AAKA,gBAAA,aALA;AAAA;AAAA,uBAMA,KAAA,CAAA,IAAA,CAAA,aAAA,CAAA,GAAA,EAAA,MAAA,EANA;;AAAA;AAMA,gBAAA,QANA;AAAA;AAAA,uBAOA,OAAA,CAAA,GAAA,CAAA,OAAA,EAAA,GAAA,CAAA,KAAA,EAAA;AAAA,kBAAA,OAAA,EAAA,IAAA,IAAA,CAAA,QAAA;AAAA,iBAAA,CAPA;;AAAA;AAAA;AAAA,uBAQA,KAAA,MAAA,CAAA,QAAA,CAAA,mBAAA,EAAA,GAAA,CAAA,KAAA,CARA;;AAAA;AASA,oBAAA,GAAA,CAAA,MAAA,KAAA,GAAA,EAAA;AACA,uBAAA,OAAA,CAAA,IAAA,CAAA,GAAA;AACA;;AAXA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AADA;AAbA,CAAA","sourcesContent":["<template>\n  <b-form @submit.prevent=\"login\" class=\"col-8\">\n    <b-form-group\n        id=\"input-group-1\"\n        label=\"Email address:\"\n        label-for=\"input-1\"\n    >\n        <b-form-input\n            id=\"input-1\"\n            v-model=\"mutableEmail\"\n            type=\"email\"\n            placeholder=\"Enter email\"\n            required\n        ></b-form-input>\n    </b-form-group>\n    <b-form-group id=\"input-group-2\" label=\"Your Password:\" label-for=\"input-2\">\n        <b-form-input\n            id=\"input-2\"\n            v-model=\"mutablePassword\"\n            placeholder=\"Enter password\"\n            required\n        ></b-form-input>\n    </b-form-group>\n    <b-button type=\"submit\" variant=\"success\">Login</b-button>\n  </b-form>\n</template>\n\n<script>\nimport users from '../api/users'\n\nimport store from '@/store/index'\nimport jwt from 'jsonwebtoken'\nimport Cookies from \"js-cookie\";\n\nimport dayjs from \"dayjs\";\nimport utc from 'dayjs/plugin/utc'\n\ndayjs.extend(utc)\n\nexport default {\n    name: 'LoginForm',\n    props: {\n        email: String,\n        password: String\n    },\n    store,\n    data() {\n        return {\n            mutableEmail: this.email,\n            mutablePassword: this.password\n        }\n    },\n    methods: {\n        login: async function() {\n            const req = await users.loginUser({\n                email: this.mutableEmail,\n                password: this.mutablePassword\n            })\n            const verifiedToken = await jwt.verify(req.token, 'secret')\n            const expToken = await dayjs.unix(verifiedToken.exp).format()\n            await Cookies.set('token', req.token, {expires: new Date(expToken)})\n            await this.$store.dispatch('users/STORE_TOKEN', req.token)\n            if (req.status === 200) {\n                this.$router.push('/')\n            }\n        }\n    }\n}\n</script>\n\n<style>\n\n</style>"],"sourceRoot":"src/molecules"}]}