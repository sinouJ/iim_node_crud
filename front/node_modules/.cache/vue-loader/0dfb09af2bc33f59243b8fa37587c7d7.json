{"remainingRequest":"/Applications/MAMP/htdocs/iim/nodejs/todo_app/front/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Applications/MAMP/htdocs/iim/nodejs/todo_app/front/src/views/Profile.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Applications/MAMP/htdocs/iim/nodejs/todo_app/front/src/views/Profile.vue","mtime":1618942441000},{"path":"/Applications/MAMP/htdocs/iim/nodejs/todo_app/front/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Applications/MAMP/htdocs/iim/nodejs/todo_app/front/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Applications/MAMP/htdocs/iim/nodejs/todo_app/front/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Applications/MAMP/htdocs/iim/nodejs/todo_app/front/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBDb29raWVzIGZyb20gJ2pzLWNvb2tpZScKaW1wb3J0IGp3dCBmcm9tICdqc29ud2VidG9rZW4nCmltcG9ydCB7IG1hcEdldHRlcnMgfSBmcm9tICd2dWV4JwppbXBvcnQgdXNlcnMgZnJvbSAnLi4vYXBpL3VzZXJzJwppbXBvcnQgZGF5anMgZnJvbSAnZGF5anMnCmltcG9ydCBQcm9maWxlRm9ybSBmcm9tICcuLi9tb2xlY3VsZXMvUHJvZmlsZUZvcm0nCgoKZXhwb3J0IGRlZmF1bHQgewogIGNvbXBvbmVudHM6IHsgUHJvZmlsZUZvcm0gfSwKICAgIG5hbWU6ICdQcm9maWxlJywKICAgIGRhdGE6IGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIGVtYWlsOiAnJywKICAgICAgICAgICAgdXNlcm5hbWU6ICcnLAogICAgICAgICAgICBiaW86ICcnCiAgICAgICAgfQogICAgfSwKICAgIGFzeW5jQ29tcHV0ZWQ6IHsKICAgICAgICAuLi5tYXBHZXR0ZXJzKCd1c2VycycsIHsKICAgICAgICAgICAgdG9rZW46ICd0b2tlbicKICAgICAgICB9KSwKICAgICAgICBhc3luYyB1c2VyICgpIHsKICAgICAgICAgICAgaWYgKHRoaXMudG9rZW4gJiYgdGhpcy50b2tlbi5pc0xvZ2dlZCkgewogICAgICAgICAgICAgICAgY29uc3QgdmVyaWZpZWRUb2tlbiA9IGp3dC52ZXJpZnkodGhpcy50b2tlbi50b2tlbiwgJ3NlY3JldCcpCiAgICAgICAgICAgICAgICBpZiAodmVyaWZpZWRUb2tlbikgewogICAgICAgICAgICAgICAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCB1c2Vycy5nZXRVc2VyKHRoaXMudG9rZW4udG9rZW4pCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVzZXIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgY3JlYXRlZERhdGU6IGZ1bmN0aW9uKCkgewogICAgICAgICAgICBpZiAodGhpcy51c2VyKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gZGF5anModGhpcy51c2VyLmNyZWF0ZWRBdCkubG9jYWxlKCdmcicpLmZvcm1hdCgnRCBNTU1NIFlZWVknKQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSwKICAgIG1vdW50ZWQoKSB7CiAgICAgICAgY29uc3QgbG9nQ29va2llID0gQ29va2llcy5nZXQoJ3Rva2VuJykKICAgICAgICBpZiAobG9nQ29va2llKSB7CiAgICAgICAgICAgIHRoaXMuJHN0b3JlLmRpc3BhdGNoKCd1c2Vycy9TVE9SRV9UT0tFTicsIGxvZ0Nvb2tpZSkKICAgICAgICB9CiAgICB9LAogICAgbWV0aG9kczogewogICAgICAgIGFjdGlvbk1vZGFsOiBmdW5jdGlvbihhY3Rpb24gPSAnaGlkZScpIHsgLy8gRGlzcGxheSBkZWZhdWx0cyB1c2VyIGluZm9ybWF0aW9ucyBpbiBmb3JtCiAgICAgICAgICAgIHRoaXMudXNlcm5hbWUgPSB0aGlzLnVzZXIudXNlcm5hbWUKICAgICAgICAgICAgdGhpcy5lbWFpbCA9IHRoaXMudXNlci5lbWFpbAogICAgICAgICAgICB0aGlzLmJpbyA9IHRoaXMudXNlci5iaW8KICAgICAgICAgICAgaWYgKGFjdGlvbiA9PT0gJ3Nob3cnKSAgdGhpcy4kYnZNb2RhbC5zaG93KCdtb2RhbC1mb3JtJykKICAgICAgICAgICAgZWxzZSB0aGlzLiRidk1vZGFsLmhpZGUoJ21vZGFsLWZvcm0nKQogICAgICAgIH0sCiAgICAgICAgdXBkYXRlQWZ0ZXJTYXZlOiBmdW5jdGlvbih1c2VyKSB7IC8vIFVwZGF0ZSBkYXRhIGZvciByZS1yZW5kZXIKICAgICAgICAgICAgdGhpcy4kYnZNb2RhbC5oaWRlKCdtb2RhbC1mb3JtJykKICAgICAgICAgICAgdGhpcy51c2VyLnVzZXJuYW1lID0gdXNlci51c2VybmFtZQogICAgICAgICAgICB0aGlzLnVzZXIuZW1haWwgPSB1c2VyLmVtYWlsCiAgICAgICAgICAgIHRoaXMudXNlci5iaW8gPSB1c2VyLmJpbwogICAgICAgIH0KICAgIH0KfQo="},{"version":3,"sources":["Profile.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4BA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Profile.vue","sourceRoot":"src/views","sourcesContent":["<template>\n    <div v-if=\"user && token && token.isLogged\">\n        <b-jumbotron>\n            <template #header>Hi, {{user.username}}</template>\n            <template #lead>\n                <b>Biography</b><br>\n                {{user.bio}}\n            </template>\n            <hr class=\"my-4\">\n            <p>Email : {{user.email}}</p>\n            <hr class=\"my-4\">\n            <p>Here since : {{createdDate}}</p>\n            <b-button variant=\"primary\" @click=\"actionModal('show')\">Edit my profile</b-button>\n        </b-jumbotron>\n        <b-modal id=\"modal-form\" centered hide-footer title=\"Edit my profile\">\n            <profile-form \n                :email=\"email\"\n                :username=\"username\"\n                :bio=\"bio\"\n                :token=\"token.token\"\n                :cancel=\"actionModal\"\n                @saved=\"updateAfterSave\"\n            />\n        </b-modal>\n    </div>\n</template>\n\n<script>\nimport Cookies from 'js-cookie'\nimport jwt from 'jsonwebtoken'\nimport { mapGetters } from 'vuex'\nimport users from '../api/users'\nimport dayjs from 'dayjs'\nimport ProfileForm from '../molecules/ProfileForm'\n\n\nexport default {\n  components: { ProfileForm },\n    name: 'Profile',\n    data: function() {\n        return {\n            email: '',\n            username: '',\n            bio: ''\n        }\n    },\n    asyncComputed: {\n        ...mapGetters('users', {\n            token: 'token'\n        }),\n        async user () {\n            if (this.token && this.token.isLogged) {\n                const verifiedToken = jwt.verify(this.token.token, 'secret')\n                if (verifiedToken) {\n                    const user = await users.getUser(this.token.token)\n                    return user\n                }\n            }\n        },\n        createdDate: function() {\n            if (this.user) {\n                return dayjs(this.user.createdAt).locale('fr').format('D MMMM YYYY')\n            }\n        }\n    },\n    mounted() {\n        const logCookie = Cookies.get('token')\n        if (logCookie) {\n            this.$store.dispatch('users/STORE_TOKEN', logCookie)\n        }\n    },\n    methods: {\n        actionModal: function(action = 'hide') { // Display defaults user informations in form\n            this.username = this.user.username\n            this.email = this.user.email\n            this.bio = this.user.bio\n            if (action === 'show')  this.$bvModal.show('modal-form')\n            else this.$bvModal.hide('modal-form')\n        },\n        updateAfterSave: function(user) { // Update data for re-render\n            this.$bvModal.hide('modal-form')\n            this.user.username = user.username\n            this.user.email = user.email\n            this.user.bio = user.bio\n        }\n    }\n}\n</script>\n\n<style>\n\n</style>"]}]}