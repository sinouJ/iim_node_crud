{"remainingRequest":"/Applications/MAMP/htdocs/iim/nodejs/todo_app/front/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Applications/MAMP/htdocs/iim/nodejs/todo_app/front/src/molecules/LoginForm.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Applications/MAMP/htdocs/iim/nodejs/todo_app/front/src/molecules/LoginForm.vue","mtime":1618942067000},{"path":"/Applications/MAMP/htdocs/iim/nodejs/todo_app/front/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Applications/MAMP/htdocs/iim/nodejs/todo_app/front/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Applications/MAMP/htdocs/iim/nodejs/todo_app/front/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Applications/MAMP/htdocs/iim/nodejs/todo_app/front/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB1c2VycyBmcm9tICcuLi9hcGkvdXNlcnMnCgppbXBvcnQgc3RvcmUgZnJvbSAnQC9zdG9yZS9pbmRleCcKaW1wb3J0IGp3dCBmcm9tICdqc29ud2VidG9rZW4nCmltcG9ydCBDb29raWVzIGZyb20gImpzLWNvb2tpZSI7CgppbXBvcnQgZGF5anMgZnJvbSAiZGF5anMiOwppbXBvcnQgdXRjIGZyb20gJ2RheWpzL3BsdWdpbi91dGMnCgpkYXlqcy5leHRlbmQodXRjKQoKZXhwb3J0IGRlZmF1bHQgewogICAgbmFtZTogJ0xvZ2luRm9ybScsCiAgICBwcm9wczogewogICAgICAgIGVtYWlsOiBTdHJpbmcsCiAgICAgICAgcGFzc3dvcmQ6IFN0cmluZwogICAgfSwKICAgIHN0b3JlLAogICAgZGF0YSgpIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgICBtdXRhYmxlRW1haWw6IHRoaXMuZW1haWwsCiAgICAgICAgICAgIG11dGFibGVQYXNzd29yZDogdGhpcy5wYXNzd29yZAogICAgICAgIH0KICAgIH0sCiAgICBtZXRob2RzOiB7CiAgICAgICAgbG9naW46IGFzeW5jIGZ1bmN0aW9uKCkgewogICAgICAgICAgICBjb25zdCByZXEgPSBhd2FpdCB1c2Vycy5sb2dpblVzZXIoewogICAgICAgICAgICAgICAgZW1haWw6IHRoaXMubXV0YWJsZUVtYWlsLAogICAgICAgICAgICAgICAgcGFzc3dvcmQ6IHRoaXMubXV0YWJsZVBhc3N3b3JkCiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIGNvbnN0IHZlcmlmaWVkVG9rZW4gPSBhd2FpdCBqd3QudmVyaWZ5KHJlcS50b2tlbiwgJ3NlY3JldCcpCiAgICAgICAgICAgIGNvbnN0IGV4cFRva2VuID0gYXdhaXQgZGF5anMudW5peCh2ZXJpZmllZFRva2VuLmV4cCkuZm9ybWF0KCkKICAgICAgICAgICAgYXdhaXQgQ29va2llcy5zZXQoJ3Rva2VuJywgcmVxLnRva2VuLCB7ZXhwaXJlczogbmV3IERhdGUoZXhwVG9rZW4pfSkKICAgICAgICAgICAgYXdhaXQgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ3VzZXJzL1NUT1JFX1RPS0VOJywgcmVxLnRva2VuKQogICAgICAgICAgICBpZiAocmVxLnN0YXR1cyA9PT0gMjAwKSB7CiAgICAgICAgICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCgnLycpCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9Cn0K"},{"version":3,"sources":["LoginForm.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4BA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"LoginForm.vue","sourceRoot":"src/molecules","sourcesContent":["<template>\n  <b-form @submit.prevent=\"login\" class=\"col-8\">\n    <b-form-group\n        id=\"input-group-1\"\n        label=\"Email address:\"\n        label-for=\"input-1\"\n    >\n        <b-form-input\n            id=\"input-1\"\n            v-model=\"mutableEmail\"\n            type=\"email\"\n            placeholder=\"Enter email\"\n            required\n        ></b-form-input>\n    </b-form-group>\n    <b-form-group id=\"input-group-2\" label=\"Your Password:\" label-for=\"input-2\">\n        <b-form-input\n            id=\"input-2\"\n            v-model=\"mutablePassword\"\n            placeholder=\"Enter password\"\n            required\n        ></b-form-input>\n    </b-form-group>\n    <b-button type=\"submit\" variant=\"success\">Login</b-button>\n  </b-form>\n</template>\n\n<script>\nimport users from '../api/users'\n\nimport store from '@/store/index'\nimport jwt from 'jsonwebtoken'\nimport Cookies from \"js-cookie\";\n\nimport dayjs from \"dayjs\";\nimport utc from 'dayjs/plugin/utc'\n\ndayjs.extend(utc)\n\nexport default {\n    name: 'LoginForm',\n    props: {\n        email: String,\n        password: String\n    },\n    store,\n    data() {\n        return {\n            mutableEmail: this.email,\n            mutablePassword: this.password\n        }\n    },\n    methods: {\n        login: async function() {\n            const req = await users.loginUser({\n                email: this.mutableEmail,\n                password: this.mutablePassword\n            })\n            const verifiedToken = await jwt.verify(req.token, 'secret')\n            const expToken = await dayjs.unix(verifiedToken.exp).format()\n            await Cookies.set('token', req.token, {expires: new Date(expToken)})\n            await this.$store.dispatch('users/STORE_TOKEN', req.token)\n            if (req.status === 200) {\n                this.$router.push('/')\n            }\n        }\n    }\n}\n</script>\n\n<style>\n\n</style>"]}]}